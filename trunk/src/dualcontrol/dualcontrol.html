
<pre>
evans@evans-Studio-1558:~$ sh /home/evans/NetBeansProjects/svn/vellum/trunk/src/dualcontrol/dualtest.sh 
CLASSPATH=/home/evans/NetBeansProjects/vellum/build/classes:/home/evans/NetBeansProjects/vellum/dist/lib/activation.jar:/home/evans/NetBeansProjects/vellum/dist/lib/commons-codec-1.7.jar:/home/evans/NetBeansProjects/vellum/dist/lib/ecj-3.7.jar:/home/evans/NetBeansProjects/vellum/dist/lib/groovy-all.jar:/home/evans/NetBeansProjects/vellum/dist/lib/gson-2.1.jar:/home/evans/NetBeansProjects/vellum/dist/lib/h2-1.3.165.jar:/home/evans/NetBeansProjects/vellum/dist/lib/iPayUtils.jar:/home/evans/NetBeansProjects/vellum/dist/lib/log4j-1.2.15.jar:/home/evans/NetBeansProjects/vellum/dist/lib/mail.jar:/home/evans/NetBeansProjects/vellum/dist/lib/postgresql-8.4-701.jdbc4.jar:/home/evans/NetBeansProjects/vellum/dist/lib/servlet-api.jar:/home/evans/NetBeansProjects/vellum/dist/lib/slf4j-api-1.5.10.jar:/home/evans/NetBeansProjects/vellum/dist/lib/slf4j-log4j12-1.5.10.jar:/home/evans/NetBeansProjects/vellum/dist/lib/smack.jar:/home/evans/NetBeansProjects/vellum/dist/lib/smackx-debug.jar:/home/evans/NetBeansProjects/vellum/dist/lib/smackx-jingle.jar:/home/evans/NetBeansProjects/vellum/dist/lib/smackx.jar:/home/evans/NetBeansProjects/vellum/dist/lib/tomcat-dbcp.jar:/home/evans/NetBeansProjects/vellum/dist/lib/tomcat-embed-core.jar:/home/evans/NetBeansProjects/vellum/dist/lib/tomcat-embed-jasper.jar:/home/evans/NetBeansProjects/vellum/dist/lib/tomcat-embed-logging-juli.jar:/home/evans/NetBeansProjects/vellum/dist/lib/tomcat-embed-logging-log4j.jar
+ secstore=/home/evans/tmp/dual.sec.jceks
+ secalias=dek-2013
+ privatestore=/home/evans/tmp/dual.private.jks
+ truststore=/home/evans/tmp/dual.public.jks
+ cert=/home/evans/tmp/dual.pem
+ pass=test1234
+ command0_testgenseckey
+ initks
+ dualalias=dualserver
+ dname=CN=server, OU=dualcontrol, O=test, L=ct, S=wp, C=za
+ rm -f /home/evans/tmp/dual.private.jks
+ rm -f /home/evans/tmp/dual.public.jks
+ rm -f /home/evans/tmp/dual.sec.jceks
+ keytool -keystore /home/evans/tmp/dual.private.jks -storepass test1234 -keypass test1234 -alias dualserver -genkeypair -dname CN=server, OU=dualcontrol, O=test, L=ct, S=wp, C=za
+ + keytool -keystore /home/evans/tmp/dual.private.jks -storepassgrep test1234 Entry -list

dualserver, 17 Aug 2013, PrivateKeyEntry, 
+ + openssl x509 -text
+ keytoolgrep -keystore Subject:
 /home/evans/tmp/dual.private.jks -storepass test1234 -keypass test1234 -alias dualserver -exportcert -rfc
        Subject: C=za, ST=wp, L=ct, O=test, OU=dualcontrol, CN=server
+ keytool -keystore /home/evans/tmp/dual.private.jks -storepass test1234 -keypass test1234 -alias dualserver -exportcert -rfc
+ keytool -keystore /home/evans/tmp/dual.public.jks -storepass test1234 -alias dualserver -importcert -noprompt -file /home/evans/tmp/dual.pem
Certificate was added to keystore
+ keytool -keystore /home/evans/tmp/dual.public.jks -storepass test1234 -list
+ grep Entry
dualserver, 17 Aug 2013, trustedCertEntry,
+ jc3
+ sleep 1
+ command1_genseckey dek-2013
+ javaks -DDualControl.alias=dek-2013 -DDualControl.inputs=3 dualcontrol.DualControlKeyTool -keystore /home/evans/tmp/dual.sec.jceks -storetype JCEKS -storepass test1234 -genseckey -keyalg DESede
+ java -Djavax.net.ssl.keyStore=/home/evans/tmp/dual.private.jks -Djavax.net.ssl.keyStorePassword=test1234 -Djavax.net.ssl.keyPassword=test1234 -Djavax.net.ssl.trustStore=/home/evans/tmp/dual.public.jks -Djavax.net.ssl.trustStorePassword=test1234 -DDualControl.alias=dek-2013 -DDualControl.inputs=3 dualcontrol.DualControlKeyTool -keystore /home/evans/tmp/dual.sec.jceks -storetype JCEKS -storepass test1234 -genseckey -keyalg DESede
DualControl waiting for info on SSL port 4444
+ jc evans:eeee
+ javaks dualcontrol.DualControlClient evans:eeee
+ java -Djavax.net.ssl.keyStore=/home/evans/tmp/dual.private.jks -Djavax.net.ssl.keyStorePassword=test1234 -Djavax.net.ssl.keyPassword=test1234 -Djavax.net.ssl.trustStore=/home/evans/tmp/dual.public.jks -Djavax.net.ssl.trustStorePassword=test1234 dualcontrol.DualControlClient evans:eeee
DualControlClient write evans:eeee
DualControl reading from socket: 127.0.0.1
+ jc hentyw:hhhh
+ javaks dualcontrol.DualControlClient hentyw:hhhh
+ java -Djavax.net.ssl.keyStore=/home/evans/tmp/dual.private.jks -Djavax.net.ssl.keyStorePassword=test1234 -Djavax.net.ssl.keyPassword=test1234 -Djavax.net.ssl.trustStore=/home/evans/tmp/dual.public.jks -Djavax.net.ssl.trustStorePassword=test1234 dualcontrol.DualControlClient hentyw:hhhh
DualControlClient write hentyw:hhhh
DualControl reading from socket: 127.0.0.1
+ jc brandonh:bbbb
+ javaks dualcontrol.DualControlClient brandonh:bbbb
+ java -Djavax.net.ssl.keyStore=/home/evans/tmp/dual.private.jks -Djavax.net.ssl.keyStorePassword=test1234 -Djavax.net.ssl.keyPassword=test1234 -Djavax.net.ssl.trustStore=/home/evans/tmp/dual.public.jks -Djavax.net.ssl.trustStorePassword=test1234 dualcontrol.DualControlClient brandonh:bbbb
DualControlClient write brandonh:bbbb
DualControl reading from socket: 127.0.0.1
DualControl input evans
DualControl input hentyw
DualControl input brandonh
DualControlKeyTool dek-2013-brandonh-evans bbbb-eeee
DualControlKeyTool dek-2013-brandonh-hentyw bbbb-hhhh
DualControlKeyTool dek-2013-evans-hentyw eeee-hhhh
+ keytool -keystore /home/evans/tmp/dual.sec.jceks -storetype JCEKS -storepass test1234 -list

Keystore type: JCEKS
Keystore provider: SunJCE

Your keystore contains 3 entries

dek-2013-brandonh-hentyw, 17 Aug 2013, SecretKeyEntry, 
dek-2013-brandonh-evans, 17 Aug 2013, SecretKeyEntry, 
dek-2013-evans-hentyw, 17 Aug 2013, SecretKeyEntry, 
+ sleep 2
+ nc -z localhost 4444
+ + jc2
command0_app
+ sleep 1
+ javaks -DDualControl.inputs=2 dualcontrol.TestApp /home/evans/tmp/dual.sec.jceks test1234 dek-2013
+ java -Djavax.net.ssl.keyStore=/home/evans/tmp/dual.private.jks -Djavax.net.ssl.keyStorePassword=test1234 -Djavax.net.ssl.keyPassword=test1234 -Djavax.net.ssl.trustStore=/home/evans/tmp/dual.public.jks -Djavax.net.ssl.trustStorePassword=test1234 -DDualControl.inputs=2 dualcontrol.TestApp /home/evans/tmp/dual.sec.jceks test1234 dek-2013
DualControl waiting for info on SSL port 4444
+ jc evans:eeee
+ javaks dualcontrol.DualControlClient evans:eeee
+ java -Djavax.net.ssl.keyStore=/home/evans/tmp/dual.private.jks -Djavax.net.ssl.keyStorePassword=test1234 -Djavax.net.ssl.keyPassword=test1234 -Djavax.net.ssl.trustStore=/home/evans/tmp/dual.public.jks -Djavax.net.ssl.trustStorePassword=test1234 dualcontrol.DualControlClient evans:eeee
DualControlClient write evans:eeee
DualControl reading from socket: 127.0.0.1
+ jc hentyw:hhhh
+ javaks dualcontrol.DualControlClient hentyw:hhhh
+ java -Djavax.net.ssl.keyStore=/home/evans/tmp/dual.private.jks -Djavax.net.ssl.keyStorePassword=test1234 -Djavax.net.ssl.keyPassword=test1234 -Djavax.net.ssl.trustStore=/home/evans/tmp/dual.public.jks -Djavax.net.ssl.trustStorePassword=test1234 dualcontrol.DualControlClient hentyw:hhhh
DualControlClient write hentyw:hhhh
DualControl reading from socket: 127.0.0.1
DualControl input evans
DualControl input hentyw
2013-08-17 15:26:17,483 INFO [DualControlApp] - init keyAlias evans-hentyw, keyPass eeee-hhhh
2013-08-17 15:26:17,484 INFO [TestApp] - main invoked with args: [/home/evans/tmp/dual.sec.jceks, test1234, dek-2013]
2013-08-17 15:26:17,484 INFO [TestApp] - loading key /home/evans/tmp/dual.sec.jceks dek-2013-evans-hentyw
2013-08-17 15:26:17,551 INFO [TestApp] - loaded key DESede
+ sleep 2
+ command0_testkeystoreserver
+ command0_keystoreserver
+ javaks dualcontrol.FileServer 127.0.0.1 4445 1 1 127.0.0.1 /home/evans/tmp/dual.sec.jceks
+ java -Djavax.net.ssl.keyStore=/home/evans/tmp/dual.private.jks -Djavax.net.ssl.keyStorePassword=test1234 -Djavax.net.ssl.keyPassword=test1234 -Djavax.net.ssl.trustStore=/home/evans/tmp/dual.public.jks -Djavax.net.ssl.trustStorePassword=test1234 dualcontrol.FileServer 127.0.0.1 4445 1 1 127.0.0.1 /home/evans/tmp/dual.sec.jceks
+ keystoreclient
+ sleep 1
+ javaks dualcontrol.FileClient 127.0.0.1 4445
+ java -Djavax.net.ssl.keyStore=/home/evans/tmp/dual.private.jks -Djavax.net.ssl.keyStorePassword=test1234 -Djavax.net.ssl.keyPassword=test1234 -Djavax.net.ssl.trustStore=/home/evans/tmp/dual.public.jks -Djavax.net.ssl.trustStorePassword=test1234 dualcontrol.FileClient 127.0.0.1 4445
FileClient 127.0.0.1:4445
2013-08-17 15:26:21,012 DEBUG [FileServer] - 127.0.0.1
FileClient read 1915 bytes
+ sleep 2
+ command0_testcryptoserver
+ command0_cryptoserver
+ javaks dualcontrol.CryptoServer 127.0.0.1 4446 1 2 127.0.0.1 /home/evans/tmp/dual.sec.jceks test1234
+ java -Djavax.net.ssl.keyStore=/home/evans/tmp/dual.private.jks -Djavax.net.ssl.keyStorePassword=test1234 -Djavax.net.ssl.keyPassword=test1234 -Djavax.net.ssl.trustStore=/home/evans/tmp/dual.public.jks -Djavax.net.ssl.trustStorePassword=test1234 dualcontrol.CryptoServer 127.0.0.1 4446 1 2 127.0.0.1 /home/evans/tmp/dual.sec.jceks test1234
+ cryptoclient
+ sleep 1
2013-08-17 15:26:23,270 INFO [CryptoServer] - args: [127.0.0.1, 4446, 1, 2, 127.0.0.1, /home/evans/tmp/dual.sec.jceks, test1234]
2013-08-17 15:26:23,281 INFO [CryptoServer] - loading keysore /home/evans/tmp/dual.sec.jceks
DualControl waiting for info on SSL port 4444
+ jc evans:eeee
+ javaks dualcontrol.DualControlClient evans:eeee
+ java -Djavax.net.ssl.keyStore=/home/evans/tmp/dual.private.jks -Djavax.net.ssl.keyStorePassword=test1234 -Djavax.net.ssl.keyPassword=test1234 -Djavax.net.ssl.trustStore=/home/evans/tmp/dual.public.jks -Djavax.net.ssl.trustStorePassword=test1234 dualcontrol.DualControlClient evans:eeee
DualControlClient write evans:eeee
DualControl reading from socket: 127.0.0.1
+ jc hentyw:hhhh
+ javaks dualcontrol.DualControlClient hentyw:hhhh
+ java -Djavax.net.ssl.keyStore=/home/evans/tmp/dual.private.jks -Djavax.net.ssl.keyStorePassword=test1234 -Djavax.net.ssl.keyPassword=test1234 -Djavax.net.ssl.trustStore=/home/evans/tmp/dual.public.jks -Djavax.net.ssl.trustStorePassword=test1234 dualcontrol.DualControlClient hentyw:hhhh
DualControlClient write hentyw:hhhh
DualControl reading from socket: 127.0.0.1
DualControl input evans
DualControl input hentyw
2013-08-17 15:26:25,282 INFO [DualControlApp] - init keyAlias evans-hentyw, keyPass eeee-hhhh
+ sleep 1
+ javaks dualcontrol.CryptoClient 127.0.0.1 4446 dek-2013:DESede/CBC/PKCS5Padding:ENCRYPT:pq7ZjIcIK9A=:111122223333444
+ java -Djavax.net.ssl.keyStore=/home/evans/tmp/dual.private.jks -Djavax.net.ssl.keyStorePassword=test1234 -Djavax.net.ssl.keyPassword=test1234 -Djavax.net.ssl.trustStore=/home/evans/tmp/dual.public.jks -Djavax.net.ssl.trustStorePassword=test1234 dualcontrol.CryptoClient 127.0.0.1 4446 dek-2013:DESede/CBC/PKCS5Padding:ENCRYPT:pq7ZjIcIK9A=:111122223333444
CryptoClient 127.0.0.1:4446, 69 bytes: dek-2013:DESede/CBC/PKCS5Padding:ENCRYPT:pq7ZjIcIK9A=:111122223333444
2013-08-17 15:26:26,782 DEBUG [CryptoServer] - 127.0.0.1
2013-08-17 15:26:26,928 INFO [CryptoServer] - read 69 bytes: dek-2013:DESede/CBC/PKCS5Padding:ENCRYPT:pq7ZjIcIK9A=:111122223333444
2013-08-17 15:26:26,928 INFO [CryptoServer] - handle 5 fields: [dek-2013, DESede/CBC/PKCS5Padding, ENCRYPT, pq7ZjIcIK9A=, 111122223333444]
2013-08-17 15:26:26,929 DEBUG [DualControlApp] - alias dek-2013-evans-hentyw, keypass eeee-hhhh
2013-08-17 15:26:26,983 INFO [CryptoServer] - keyalg DESede
2013-08-17 15:26:26,983 INFO [CryptoServer] - mode ENCRYPT
2013-08-17 15:26:26,992 INFO [CryptoServer] - iv pq7ZjIcIK9A=
2013-08-17 15:26:26,994 INFO [CryptoServer] - encrypted MUcRWyo0yPYhdiaaKMJlvw==
iv 8: pq7ZjIcIK9A=
bytes 16: MUcRWyo0yPYhdiaaKMJlvw==
+ data=pq7ZjIcIK9A=:MUcRWyo0yPYhdiaaKMJlvw==
+ javaks dualcontrol.CryptoClient 127.0.0.1 4446 dek-2013:DESede/CBC/PKCS5Padding:DECRYPT:pq7ZjIcIK9A=:MUcRWyo0yPYhdiaaKMJlvw==
+ java -Djavax.net.ssl.keyStore=/home/evans/tmp/dual.private.jks -Djavax.net.ssl.keyStorePassword=test1234 -Djavax.net.ssl.keyPassword=test1234 -Djavax.net.ssl.trustStore=/home/evans/tmp/dual.public.jks -Djavax.net.ssl.trustStorePassword=test1234 dualcontrol.CryptoClient 127.0.0.1 4446 dek-2013:DESede/CBC/PKCS5Padding:DECRYPT:pq7ZjIcIK9A=:MUcRWyo0yPYhdiaaKMJlvw==
CryptoClient 127.0.0.1:4446, 78 bytes: dek-2013:DESede/CBC/PKCS5Padding:DECRYPT:pq7ZjIcIK9A=:MUcRWyo0yPYhdiaaKMJlvw==
2013-08-17 15:26:27,519 DEBUG [CryptoServer] - 127.0.0.1
2013-08-17 15:26:27,671 INFO [CryptoServer] - read 78 bytes: dek-2013:DESede/CBC/PKCS5Padding:DECRYPT:pq7ZjIcIK9A=:MUcRWyo0yPYhdiaaKMJlvw==
2013-08-17 15:26:27,672 INFO [CryptoServer] - handle 5 fields: [dek-2013, DESede/CBC/PKCS5Padding, DECRYPT, pq7ZjIcIK9A=, MUcRWyo0yPYhdiaaKMJlvw==]
2013-08-17 15:26:27,672 DEBUG [DualControlApp] - alias dek-2013-evans-hentyw, keypass eeee-hhhh
2013-08-17 15:26:27,675 INFO [CryptoServer] - keyalg DESede
2013-08-17 15:26:27,675 INFO [CryptoServer] - mode DECRYPT
2013-08-17 15:26:27,676 INFO [CryptoServer] - decrypted 111122223333444
+ sleep 2
iv 8: pq7ZjIcIK9A=
bytes 15: MTExMTIyMjIzMzMzNDQ0
+ command0_client
+ javaks dualcontrol.DualControlClient
+ java -Djavax.net.ssl.keyStore=/home/evans/tmp/dual.private.jks -Djavax.net.ssl.keyStorePassword=test1234 -Djavax.net.ssl.keyPassword=test1234 -Djavax.net.ssl.trustStore=/home/evans/tmp/dual.public.jks -Djavax.net.ssl.trustStorePassword=test1234 dualcontrol.DualControlClient
DualControl username: evans  
DualControl password: 
DualControlClient write evans:eeee
</pre>