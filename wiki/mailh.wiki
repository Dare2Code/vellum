
<code language="sh">

evans@bizserver ~: echo "test message" | mailh --pre --tee -s "test subject" evans@gmail.com
from: evans@bizserver.net
to: evans@gmail.com
date: 2012-02-17 17:40:38
subject: test subject
<pre>
test message

evans@bizserver ~:  cat /usr/local/bin/mailh 

tmp=/tmp/``basename $0``-$USER-$$.tmp

tee=0
hostname=``hostname -s``
from=$USER@`hostname`
subject="$hostname mailer"
timestamp=``date +'%Y-%m-%d %T'``

while [ $# -gt 0 ]
do
  if [ "$1" = "--pre" ]
  then
    echo "<pre>" > $tmp
  elif [ "$1" = "--tee" ]
  then
    tee=1
  elif [ "$1" = "-s" ]
  then
    if [ $# -gt 0 ]
    then
      shift
      subject=$1
    fi
  else
    echo "$1" | grep -q "@"
    if [ $? -eq 0 ]
    then
      break
    else
      subject=$1
    fi
  fi
  shift
done

to=evans@ipay.co.za
if [ $# -gt 0 ]
then
  to=$@
fi

cat >> $tmp

if \[ ``cat $tmp | wc -c | bc`` -gt 1 \]
then
  cat $tmp | /opt/mutt-1.5.21/bin/mutt -e 'set content_type="text/html"' -s "$subject" $to
fi

if \[ $tee -eq 1 \]
then
  echo "from: $from"
  echo "to: $to"
  echo "date: $timestamp"
  echo "subject: $subject"
  cat $tmp
fi

rm $tmp
</code>